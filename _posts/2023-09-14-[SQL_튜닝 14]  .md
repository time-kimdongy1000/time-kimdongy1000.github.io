---
title: SQL_튜닝_14
author: kimdongy1000
date: 2023-09-14 10:00
categories: [Back-end, SQL_Tuning]
tags: [DataBase - Oracle , SQL_Tuning]
math: true
mermaid: true
---

## SELECT-LIST 컬럼 가공
SELECT - LIST 라고 해서 거창하게 있는게 아니라 SELECT 의 결과가 1개이면 SELECT - ONE 이고 여러개면 SELECT - LIST 입니다 그래서 java 의 mybatis 도 이를 구분해서 메서드를 만들어둡니다 

```
@Autowired
private SqlSessionTemplate sqlSessionTemplate;

sqlSessionTemplate.selectList();
sqlSessionTemplate.selectOne();


```

이렇게 SqlSessionTemplate 이 나뉘게 됩니다 


## java 소스예제 

<https://gitlab.com/kimdongy1000/sqltuningproject>

이곳에서 Ex4_custom 를 찾자 아래 .sql 파일도 스키마도 마련해두었습니다 예제는 계속해서 Ex4_Custom 를 사용하겠습니다 

## 간단한 테이블 스키마
```

DROP TABLE Ex4_Custom 

CREATE TABLE Ex4_Custom(
	
	customApplyDate varchar(8), 
	customName      varchar(11),
	customSex       varchar(2),
	customAge       number(2)
	
)

CREATE INDEX Ex4_Custom_idx ON Ex4_Custom (customApplyDate , customName , customSex , customAge);
```



##  SORT AGGREGATE
```
EXPLAIN PLAN FOR 
SELECT MIN(A.customAge) customAge
FROM Ex4_Custom A
WHERE A.customApplyDate > '20010101'	

SELECT * FROM TABLE(DBMS_XPLAN.DISPLAY);

PLAN_TABLE_OUTPUT                                                                   |
------------------------------------------------------------------------------------+
Plan hash value: 3022444818                                                         |
                                                                                    |
------------------------------------------------------------------------------------|
| Id  | Operation         | Name           | Rows  | Bytes | Cost (%CPU)| Time     ||
------------------------------------------------------------------------------------|
|   0 | SELECT STATEMENT  |                |     1 |    12 |    11   (0)| 00:00:01 ||
|   1 |  SORT AGGREGATE   |                |     1 |    12 |            |          ||
|*  2 |   INDEX RANGE SCAN| EX4_CUSTOM_IDX |  1862 | 22344 |    11   (0)| 00:00:01 ||
------------------------------------------------------------------------------------|
                                                                                    |
Predicate Information (identified by operation id):                                 |
---------------------------------------------------                                 |
                                                                                    |
   2 - access("A"."CUSTOMAPPLYDATE">'20010101' AND "A"."CUSTOMAPPLYDATE" IS         |
              NOT NULL)                                                             |

```
해당쿼리는 선두컬럼이 WHERE 절에 들어 가 있는 상태로 인덱스 컬럼 일부분

